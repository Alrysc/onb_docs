
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://alrysc.github.io/onb_docs/v2.1/recommended_upgrades/">
      
      
        <link rel="prev" href="../changelog/">
      
      
        <link rel="next" href="../breaking_changes/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Recommended Upgrades - ONB Modding</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#recommended-mod-upgrades" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ONB Modding" class="md-header__button md-logo" aria-label="ONB Modding" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ONB Modding
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Recommended Upgrades
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="indigo"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../lua/" class="md-tabs__link">
          
  
  
  Lua Primer

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../onb_overview/" class="md-tabs__link">
          
  
  
  Engine Objects

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview/" class="md-tabs__link">
          
  
  
  v2.1 Changes

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ONB Modding" class="md-nav__button md-logo" aria-label="ONB Modding" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ONB Modding
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Lua Primer
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Lua Primer
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/comments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Comments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Variables
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Variables
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/variables/numbers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Numbers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/variables/strings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Strings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/variables/booleans/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Booleans
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/variables/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/variables/tables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/boolean_expressions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Boolean Expressions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/comparisons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Comparisons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/control_structures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Control Structures
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/scope/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scope
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/objects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tables As Objects
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lua/useful_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Useful Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Engine Objects
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Engine Objects
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/field.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Field
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Entities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Entities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/entities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Entity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/entities/artifact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Artifact
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/entities/spell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spell
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/entities/obstacle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Obstacle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/entities/character/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Character
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/entities/player/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Player
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Enums
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Enums
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/element/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Element
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/hit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/tilestate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TileState
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/direction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Direction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/team/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Team
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/lifetimes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lifetimes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/defenseorder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DefenseOrder
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/locktype/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LockType
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/input/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Input
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/rank/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rank
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/highlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Highlight
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/shadow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Shadow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/colormode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ColorMode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/playback/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Playback
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/audiopriority/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AudioPriority
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/audiotype/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AudioType
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/cardclass/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CardClass
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/blocks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blocks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../onb_overview/enums/entitystatus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EntityStatus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    v2.1 Changes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    v2.1 Changes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Full Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Recommended Upgrades
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Recommended Upgrades
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#new-feature-possibilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        New Feature Possibilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="New Feature Possibilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#let-engine-handle-hit-sounds" class="md-nav__link">
    <span class="md-ellipsis">
      
        Let Engine Handle Hit Sounds
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Let Engine Handle Hit Sounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-hurt-sounds" class="md-nav__link">
    <span class="md-ellipsis">
      
        Default Hurt Sounds
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-default-sound" class="md-nav__link">
    <span class="md-ellipsis">
      
        Change Default Sound
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#override-damage-sound-for-defense" class="md-nav__link">
    <span class="md-ellipsis">
      
        Override Damage Sound For Defense
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#override-damage-sound-for-attack" class="md-nav__link">
    <span class="md-ellipsis">
      
        Override Damage Sound For Attack
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-charge-times" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Charge Times
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suggest-gfx-spawn" class="md-nav__link">
    <span class="md-ellipsis">
      
        Suggest GFX Spawn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-to-shoulder-buttons" class="md-nav__link">
    <span class="md-ellipsis">
      
        Access to Shoulder Buttons
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#safer-card_action_event" class="md-nav__link">
    <span class="md-ellipsis">
      
        Safer card_action_event
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hitnocounter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hit.NoCounter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-confusion-and-blind" class="md-nav__link">
    <span class="md-ellipsis">
      
        Check Confusion and Blind
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#battle_end_func-and-battle_start_func" class="md-nav__link">
    <span class="md-ellipsis">
      
        battle_end_func and battle_start_func
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timefreeze-action_end_func" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeFreeze action_end_func
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timefreeze-uncounterable" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeFreeze Uncounterable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_counter_frame_range" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_counter_frame_range
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#breaking-metal-tiles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Breaking Metal Tiles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#engine-alert-symbol" class="md-nav__link">
    <span class="md-ellipsis">
      
        Engine Alert Symbol
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turn-counting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Turn Counting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-hitprops-constructor" class="md-nav__link">
    <span class="md-ellipsis">
      
        New HitProps Constructor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-element2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use element2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-status-durations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use Status Durations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custgauge-manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        CustGauge Manipulation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#behavior-changes-be-aware" class="md-nav__link">
    <span class="md-ellipsis">
      
        Behavior Changes (Be Aware)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Behavior Changes (Be Aware)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-hitdrag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using Hit.Drag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drag-endlag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Drag Endlag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#movement-endlag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Movement Endlag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spawning-hit-effects" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spawning Hit Effects
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleting-moving-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deleting Moving Attacks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_nearest_characters-fix" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_nearest_characters Fix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fire-and-grass" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fire and Grass
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grass-lava-effects" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grass, Lava Effects
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-tilestates" class="md-nav__link">
    <span class="md-ellipsis">
      
        New TileStates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#double-hit-sound" class="md-nav__link">
    <span class="md-ellipsis">
      
        Double Hit Sound
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../breaking_changes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Breaking Changes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#new-feature-possibilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        New Feature Possibilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="New Feature Possibilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#let-engine-handle-hit-sounds" class="md-nav__link">
    <span class="md-ellipsis">
      
        Let Engine Handle Hit Sounds
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Let Engine Handle Hit Sounds">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-hurt-sounds" class="md-nav__link">
    <span class="md-ellipsis">
      
        Default Hurt Sounds
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-default-sound" class="md-nav__link">
    <span class="md-ellipsis">
      
        Change Default Sound
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#override-damage-sound-for-defense" class="md-nav__link">
    <span class="md-ellipsis">
      
        Override Damage Sound For Defense
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#override-damage-sound-for-attack" class="md-nav__link">
    <span class="md-ellipsis">
      
        Override Damage Sound For Attack
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-charge-times" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Charge Times
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#suggest-gfx-spawn" class="md-nav__link">
    <span class="md-ellipsis">
      
        Suggest GFX Spawn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-to-shoulder-buttons" class="md-nav__link">
    <span class="md-ellipsis">
      
        Access to Shoulder Buttons
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#safer-card_action_event" class="md-nav__link">
    <span class="md-ellipsis">
      
        Safer card_action_event
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hitnocounter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hit.NoCounter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-confusion-and-blind" class="md-nav__link">
    <span class="md-ellipsis">
      
        Check Confusion and Blind
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#battle_end_func-and-battle_start_func" class="md-nav__link">
    <span class="md-ellipsis">
      
        battle_end_func and battle_start_func
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timefreeze-action_end_func" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeFreeze action_end_func
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timefreeze-uncounterable" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeFreeze Uncounterable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_counter_frame_range" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_counter_frame_range
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#breaking-metal-tiles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Breaking Metal Tiles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#engine-alert-symbol" class="md-nav__link">
    <span class="md-ellipsis">
      
        Engine Alert Symbol
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turn-counting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Turn Counting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-hitprops-constructor" class="md-nav__link">
    <span class="md-ellipsis">
      
        New HitProps Constructor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-element2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use element2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-status-durations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use Status Durations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custgauge-manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        CustGauge Manipulation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#behavior-changes-be-aware" class="md-nav__link">
    <span class="md-ellipsis">
      
        Behavior Changes (Be Aware)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Behavior Changes (Be Aware)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-hitdrag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using Hit.Drag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drag-endlag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Drag Endlag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#movement-endlag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Movement Endlag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spawning-hit-effects" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spawning Hit Effects
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleting-moving-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deleting Moving Attacks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find_nearest_characters-fix" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_nearest_characters Fix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fire-and-grass" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fire and Grass
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grass-lava-effects" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grass, Lava Effects
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-tilestates" class="md-nav__link">
    <span class="md-ellipsis">
      
        New TileStates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#double-hit-sound" class="md-nav__link">
    <span class="md-ellipsis">
      
        Double Hit Sound
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="recommended-mod-upgrades">Recommended Mod Upgrades</h1>
<p>The vast majority of mods do not need upgrades to work in the new version. However, there 
are many new features available that modders will want to use to improve their mods, including 
things that were previously impossible. </p>
<p>Some of these recommendations are to warn about behavioral changes, which may affect how a mod 
works, but most likely leave it working. Other recommendations are for new things that can be added 
to mods to either make certain logic safer, or improve mods with new functionality. These 
are separated by section.</p>
<p>This page also covers usage suggestions and examples for new features.</p>
<h2 id="new-feature-possibilities">New Feature Possibilities</h2>
<h3 id="let-engine-handle-hit-sounds">Let Engine Handle Hit Sounds</h3>
<p>v2.1 allows many mods to remove the hit sounds included in their mods. This has technically 
always been true because of the <a href="../../onb_overview/enums/audiotype/"><code>AudioType</code> enum</a>, but 
now the engine can take full control and even play different hit sounds depending on what 
an attack hit.</p>
<p>For most people, this means you don't have to provide hit sounds in most of your mods anymore, 
or handle playing them, unless you specifically want a custom hit SFX different from the default.</p>
<p>Note that the SFX will only play when the attack is not blocked, it does more than 0 damage, 
and it has the <code>Hit.Impact</code> flag. This should not be concerning and is likely what is intended 
by all mods regardless, as hit sounds act like this in Battle Network, too. If you want to play a 
hit sound and you know it doesn't fall under these situations, you may still want to call 
<code>Engine.play_audio</code>. Otherwise, you should be able to safely remove it and associated audio 
files from your mods.</p>
<h4 id="default-hurt-sounds">Default Hurt Sounds</h4>
<p>This is all because Entities now have "default hurt sounds", which will play after the <code>Spell.attack_func</code>
runs, if damage from an attack was not blocked, was &gt; 0, and the attack had the <code>Hit.Impact flag</code>. 
There are three different defaults:</p>
<ul>
<li>The sound you hear when damaging an Obstacle in BN (default for all Obstacles)</li>
<li>The sound you hear when damaging an enemy in BN (default for all other Entities)</li>
<li>The sound you hear when the player is damaged in BN (default for only the local Player)</li>
</ul>
<p>This means that, in PvP, you will hear a different sound when you get damage than you hear when 
you damage the enemy player.</p>
<h4 id="change-default-sound">Change Default Sound</h4>
<p>You can change the default hurt sound for an Entity. This requires two function calls: one to 
set the new sound to use, and one to toggle whether or not your custom sound should be used.</p>
<p><div class="language-lua highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">my_hurt_sfx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Engine</span><span class="p">.</span><span class="nf">load_audio</span><span class="p">(</span><span class="nv">_folderpath</span><span class="o">..</span><span class="s2">&quot;hurt.ogg&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kr">function</span><span class="w"> </span><span class="nf">player_init</span><span class="p">(</span><span class="nv">player</span><span class="p">)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="nv">player</span><span class="p">:</span><span class="nf">use_default_hurt_sfx</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="nv">player</span><span class="p">:</span><span class="nf">set_hurt_sfx</span><span class="p">(</span><span class="nv">my_hurt_sfx</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kr">end</span>
</span></code></pre></div>
This also works with the <code>AudioType</code> enum.
<div class="language-lua highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kr">function</span><span class="w"> </span><span class="nf">player_init</span><span class="p">(</span><span class="nv">player</span><span class="p">)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="nv">player</span><span class="p">:</span><span class="nf">use_default_hurt_sfx</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="c1">-- Player will play the Explode sound whenever damaged</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="nv">player</span><span class="p">:</span><span class="nf">set_hurt_sfx</span><span class="p">(</span><span class="nv">AudioType</span><span class="p">.</span><span class="py">Explode</span><span class="p">)</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="kr">end</span>
</span></code></pre></div></p>
<p>You can also use <code>nil</code> as the hurt SFX to play no sound.</p>
<h4 id="override-damage-sound-for-defense">Override Damage Sound For Defense</h4>
<p>Sometimes, you may want a DefenseRule to play a sound when the Entity gets hit. Often 
a hit sound won't play, because a DefenseRule usually blocks attacks, but this isn't 
always the case. Maybe your DefenseRule allows the user to still be damaged, but it creates 
some extra effect and you want a different hurt sound. </p>
<p>This can be done using the judge's new <code>set_hit_sfx</code> function. This can override the 
sound that the Entity has set for their hurt SFX to play your own.</p>
<p><div class="language-lua highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">my_hit_sfx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Engine</span><span class="p">.</span><span class="nf">load_audio</span><span class="p">(</span><span class="nv">_folderpath</span><span class="o">..</span><span class="s2">&quot;hit.ogg&quot;</span><span class="p">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kd">local</span><span class="w"> </span><span class="nv">defense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Battle</span><span class="p">.</span><span class="py">DefenseRule</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nv">DefenseOrder</span><span class="p">.</span><span class="py">CollisionOnly</span><span class="p">)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nv">defense</span><span class="p">.</span><span class="py">can_block_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">judge</span><span class="p">,</span><span class="w"> </span><span class="nv">attacker</span><span class="p">,</span><span class="w"> </span><span class="nv">defender</span><span class="p">)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="nv">judge</span><span class="p">:</span><span class="nf">set_hit_sfx</span><span class="p">(</span><span class="nv">my_hit_sfx</span><span class="p">)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="kr">end</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="nv">player</span><span class="p">:</span><span class="nf">add_defense_rule</span><span class="p">(</span><span class="nv">defense</span><span class="p">)</span>
</span></code></pre></div>
The above DefenseRule will override the SFX to play after damage, so that instead of using 
the hurt Entity's set SFX, it will use the one set here. An <code>AudioType</code> enum value also works.
<div class="language-lua highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">defense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Battle</span><span class="p">.</span><span class="py">DefenseRule</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nv">DefenseOrder</span><span class="p">.</span><span class="py">CollisionOnly</span><span class="p">)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nv">defense</span><span class="p">.</span><span class="py">can_block_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">judge</span><span class="p">,</span><span class="w"> </span><span class="nv">attacker</span><span class="p">,</span><span class="w"> </span><span class="nv">defender</span><span class="p">)</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="nv">judge</span><span class="p">:</span><span class="nf">set_hit_sfx</span><span class="p">(</span><span class="nv">AudioType</span><span class="p">.</span><span class="py">Explode</span><span class="p">)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="kr">end</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="nv">player</span><span class="p">:</span><span class="nf">add_defense_rule</span><span class="p">(</span><span class="nv">defense</span><span class="p">)</span>
</span></code></pre></div>
You can also use a value of <code>nil</code> to prevent any sound from playing. </p>
<p>A DefenseRule that runs after yours may set the SFX again, which will overwrite your change. 
The attacker has the final say in the damage sound, however. </p>
<div class="admonition tip">
<p class="admonition-title">'hit' vs. 'hurt'</p>
<p>Make sure to notice that <code>Entity</code> uses <code>hurt</code> in <code>Entity.use_default_hurt_sfx</code> and 
<code>Entity.set_hurt_sfx</code>, but <code>DefenseFrameStateJudge</code> uses <code>hit</code> in <code>DefenseFrameStateJudge.set_hit_sfx</code>.</p>
</div>
<h4 id="override-damage-sound-for-attack">Override Damage Sound For Attack</h4>
<p>Sometimes, you may want an attack you make to play a different sound. You can still call 
<code>Engine.play_audio</code> in your <code>attack_func</code>, but this will play the sound at the same time as the 
enemy hit sound. </p>
<p>Attacks have the final say in what SFX will play, since they can run logic after every other 
possible change was made. Because the <code>DefenseFrameStateJudge</code> is now passed into the <code>attack_func</code> 
and <code>collision_func</code> of Spells and other hitboxes, you can use its new <code>set_hit_sfx</code> function to 
determine what sound will play when damage is dealt. For example, 
<div class="language-lua highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">my_hit_sfx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Engine</span><span class="p">.</span><span class="nf">load_audio</span><span class="p">(</span><span class="nv">_folderpath</span><span class="o">..</span><span class="s2">&quot;hit.ogg&quot;</span><span class="p">)</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nv">spell</span><span class="p">.</span><span class="py">attack_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">other</span><span class="p">,</span><span class="w"> </span><span class="nv">judge</span><span class="p">)</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="nv">judge</span><span class="p">:</span><span class="nf">set_hit_sfx</span><span class="p">(</span><span class="nv">my_hit_sfx</span><span class="p">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="kr">end</span>
</span></code></pre></div>
The above code will cause your own SFX to play. You can similarly use an <code>AudioType</code> enum value instead.
<div class="language-lua highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nv">spell</span><span class="p">.</span><span class="py">attack_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">other</span><span class="p">,</span><span class="w"> </span><span class="nv">judge</span><span class="p">)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="c1">-- Play the explosion sound</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="nv">judge</span><span class="p">:</span><span class="nf">set_hit_sfx</span><span class="p">(</span><span class="nv">AudioType</span><span class="p">.</span><span class="py">Explosion</span><span class="p">)</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="kr">end</span>
</span></code></pre></div></p>
<p><code>nil</code> is also a valid value and will cause no sound to play. You might use this also in cases where
you want your non-Impact attack to make a hit sound, so you used <code>Engine.play_audio</code>, and want to 
ensure no other sound plays at the same time.</p>
<div class="admonition tip">
<p class="admonition-title">'hit' vs. 'hurt'</p>
<p>Make sure to notice that <code>Entity</code> uses <code>hurt</code> in <code>Entity.use_default_hurt_sfx</code> and 
<code>Entity.set_hurt_sfx</code>, but <code>DefenseFrameStateJudge</code> uses <code>hit</code> in <code>DefenseFrameStateJudge.set_hit_sfx</code>.</p>
</div>
<h3 id="custom-charge-times">Custom Charge Times</h3>
<p>v2.1 fixes charge time calculation, which means Player mods are free to have unique 
charge times. If you do not add one, the mod will continue to use the default 
provided by the engine.</p>
<p>This is done using the <code>charge_time_func</code>, both on Players and on PlayerForms.
The <code>charge_time_func</code> is passed a reference to the Player, and a number <code>level</code> 
representing the current Charge level, and expects a <code>frametime</code> to be returned. 
The <code>level</code> will be a number from 1 to 5, inclusive. Be sure to cover all cases.</p>
<div class="language-lua highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">form</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">player</span><span class="p">:</span><span class="nf">create_form</span><span class="p">()</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nv">player</span><span class="p">.</span><span class="py">charge_time_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">level</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">level</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">then</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="nf">frames</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="kr">end</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">level</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="nf">frames</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">    </span><span class="kr">end</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">    </span><span class="c1">-- etc.</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="kr">end</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="c1">-- Note that the form receives the Player, not itself, in the parameters, </span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="c1">-- so standard practice of using `self` as the first parameter is incorrect.</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="nv">form</span><span class="p">.</span><span class="py">charge_time_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">player</span><span class="p">,</span><span class="w"> </span><span class="nv">level</span><span class="p">)</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">level</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">then</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="nf">frames</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">    </span><span class="kr">end</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">level</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="nf">frames</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="w">    </span><span class="kr">end</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="w">    </span><span class="c1">-- etc.</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="kr">end</span>
</span></code></pre></div>
<p>Some tips for determining charge times:</p>
<ul>
<li>The default charge time is 90 frames at level 1, 80 at level 2, 70 at level 3, 60 at level 4, and 50 and level 5.</li>
<li>If your charge time can be based on a formula, use one<ul>
<li>For exmaple, the ONB default can be replicated in one line with <code>return frames(100 - 10 * level)</code></li>
</ul>
</li>
<li>The official games often do not use linear charge times. For example, HeatCross in BN6 has times 
 60, 50, 40, 35, 30, for levels 1-5. Notice how having more levels past 3 has lesser effect.</li>
<li>The returned time is applied <em>after</em> holding the Shoot button for 10 frames (when the graphic appears)<ul>
<li>This means returning <code>frames(10)</code> actually means you need to hold B for 20 frames total to be fully charged</li>
<li>Sources on charge times for the official games may or may not count the 10 frames before holding Shoot. 
Take this into consideration when taking data from other sources. </li>
</ul>
</li>
</ul>
<p>If your mod changes the <code>Player.charged_attack_func</code>, consider also changing the <code>Player.charge_time_func</code>.</p>
<h3 id="suggest-gfx-spawn">Suggest GFX Spawn</h3>
<p>In the original games, there are some Defenses which allow graphical effects to spawn even though 
the attack was blocked, and others that don't. Spells can simply spawn graphics wherever and whenever 
they want, but you can now have your DefenseRules suggest that they don't spawn a graphic. This is 
not foolproof, as mods needs to read this and decide to listen, but it allows for the option. </p>
<p>This comes from <code>DefenseFrameStateJudge.hint_spawn_gfx</code>. If called, it will return <code>true</code> or <code>false</code>, 
based on whether or not it has been suggested that GFX should or shouldn't spawn. If called by passing 
in a boolean instead, it will set the return value to be given later.</p>
<p><div class="language-lua highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">defense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Battle</span><span class="p">.</span><span class="py">DefenseRule</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nv">DefenseOrder</span><span class="p">.</span><span class="py">CollisionOnly</span><span class="p">)</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nv">defense</span><span class="p">.</span><span class="py">can_block_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">judge</span><span class="p">,</span><span class="w"> </span><span class="nv">attacker</span><span class="p">,</span><span class="w"> </span><span class="nv">defender</span><span class="p">)</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="c1">-- Ask attackers to not spawn GFX</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="nv">judge</span><span class="p">:</span><span class="nf">hint_spawn_gfx</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="kr">end</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="nv">player</span><span class="p">:</span><span class="nf">add_defense_rule</span><span class="p">(</span><span class="nv">defense</span><span class="p">)</span>
</span></code></pre></div>
With this DefenseRule, you might have an attacker like so:
<div class="language-lua highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nv">spell</span><span class="p">.</span><span class="py">collision_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">other</span><span class="p">,</span><span class="w"> </span><span class="nv">judge</span><span class="p">)</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span><span class="c1">-- Stop if the judge has asked not to spawn GFX</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">judge</span><span class="p">:</span><span class="nf">hint_spawn_gfx</span><span class="p">()</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="kr">return</span><span class="w"> </span><span class="kr">end</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">    </span><span class="c1">-- Put code for spawning hit effect here</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="kr">end</span>
</span></code></pre></div></p>
<p>It's recommended to have your attacks listen to the DefenseFrameStateJudge.</p>
<h3 id="access-to-shoulder-buttons">Access to Shoulder Buttons</h3>
<p>v2.1 adds the <code>Right_Shoulder</code> and <code>Left_Shoulder</code> inputs to be read by mods. You 
can perform some logic based on these, and you might have some mods that were getting 
especially crowded using only the Special button. </p>
<p>Note that the shoulders are typically used to open the Custom screen. Your logic may 
be performed at the same time the Custom screen opens if the Custom Gauge is full.</p>
<h3 id="safer-card_action_event">Safer card_action_event</h3>
<p>In v2.0, if you used <code>Character.card_action_event</code>, you had no way of knowing whether 
or not the Card would be added or would execute, or even could execute. You might 
have queued the action multiple times, causing it to happen more times than intended. 
With v2.1, this can be made somewhat safer because we can check whether or not the 
Character is available to perform an action using <code>Character.can_attack</code>.</p>
<p><code>Character.can_attack</code> returns false if the Character already has a CardAction, or 
is flinching, stunned, frozen, or in the middle of Drag. By combining this with a 
check for <code>Entity.is_moving</code>, you can more consistently avoid queueing the action 
multiple times, since the frame after you queue the action <code>Character.can_attack</code> will 
return false until the action has either finished or been discarded.</p>
<p><div class="language-lua highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nv">player</span><span class="p">.</span><span class="py">update_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">self</span><span class="p">)</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="kd">local</span><span class="w"> </span><span class="nv">can_act</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">player</span><span class="p">:</span><span class="nf">can_attack</span><span class="p">()</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">player</span><span class="p">:</span><span class="nf">is_moving</span><span class="p">()</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">can_act</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nv">player</span><span class="p">:</span><span class="nf">input_has</span><span class="p">(</span><span class="nv">Input</span><span class="p">.</span><span class="py">Pressed</span><span class="p">.</span><span class="py">Left_Shoulder</span><span class="p">)</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">        </span><span class="nv">player</span><span class="p">:</span><span class="nf">card_action_event</span><span class="p">(</span><span class="nf">make_my_action</span><span class="p">(),</span><span class="w"> </span><span class="nv">ActionOrder</span><span class="p">.</span><span class="py">Voluntary</span><span class="p">)</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="kr">end</span><span class="w"> </span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="kr">end</span>
</span></code></pre></div>
If the above code did not make those checks, a player could repeatedly press the left shoulder
button and queue the action multiple times, or could even press it while stunned and have the 
action happen immediately when stun ends. Guarding the <code>card_action_event</code> with <code>can_attack</code> 
and <code>is_moving</code> prevents this.</p>
<h3 id="hitnocounter">Hit.NoCounter</h3>
<p>You can now make attacks that can never counterhit. In v2.0, this was able to be done using 
the raw value of the enum (2048), but now the enum value is accessible using <code>Hit.NoCounter</code>. 
If you used <code>2048</code>, consider updating to use the enum value, which is guaranteed to always 
work in the future.</p>
<h3 id="check-confusion-and-blind">Check Confusion and Blind</h3>
<p>In the original games, enemies would often act differently than normal if they were blind 
or confused. Modders can now check for these conditions with <code>Entity.is_confused</code> and 
<code>Entity.is_blind</code>.</p>
<p>According to K1rbyat1na, confused enemies in BN3/EXE3 acted the same as if they were rooted, 
so their movements will not happen. But in later games, confused enemies act the same as 
if they were blinded, which means, quoted:
"
1. They have a longer idle delay.
2. They can't choose the correct tile for an attack and choose it randomly (e.g., StarMan using Star Arrow).
3. They skip attacks that require moving to a specific tile (e.g., StarMan using Moon Dance).</p>
<p>Some bosses have unique features in the Blind state. For example, Blinded Forte always excludes tiles 
containing the player when using Shooting Buster so he never hits them.
"</p>
<p>You might consider following this for your mods to be closer to the source material.</p>
<h3 id="battle_end_func-and-battle_start_func"><code>battle_end_func</code> and <code>battle_start_func</code></h3>
<p>All Entities can use the <code>battle_start_func</code> and <code>battle_end_func</code> now. This is most likely 
to come up where modders have wanted to remove Spells from the Field when battle ends, or 
prevent enemies from spawning new attacks, which is common for official game behavior. </p>
<h3 id="timefreeze-action_end_func">TimeFreeze action_end_func</h3>
<p>In v2.0, time freeze CardActions did not call their <code>action_end_func</code>. This has been fixed. 
If your mods had certain cleanup that must be performed at the end, this could be a good 
place to move things.</p>
<h3 id="timefreeze-uncounterable">TimeFreeze Uncounterable</h3>
<p>Time freeze actions can now be marked as uncounterable, using <code>CardMeta.counterable = false</code>.</p>
<p>Try not to abuse it too much. This is typically used for time freezes that happen as a 
result of some condition, like Guardian being hit, or an elemental attack appearing 
on the field and triggering ElementTrap, or a boss changing phases. Mods that have these 
sorts of actions likely already wanted to be uncounterable, and now they can be. Generally 
recommended to go with <code>skip_time_freeze_intro</code> being true.</p>
<h3 id="set_counter_frame_range">set_counter_frame_range</h3>
<p>Instead of toggling counter on and off, you can now set a range of animation keyframes
for which an Entity will be counterable. This is based on the current animation.</p>
<div class="language-lua highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nv">action</span><span class="p">.</span><span class="py">execute_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">actor</span><span class="p">)</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="nv">actor</span><span class="p">:</span><span class="nf">set_counter_frame_range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="kr">end</span>
</span></code></pre></div>
<p>The above code is equivalent to 
<div class="language-lua highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nv">action</span><span class="p">.</span><span class="py">execute_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="nv">actor</span><span class="p">)</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="nv">action</span><span class="p">:</span><span class="nf">add_anim_action</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">()</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">        </span><span class="nv">actor</span><span class="p">:</span><span class="nf">toggle_counter</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="kr">end</span><span class="p">)</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="nv">action</span><span class="p">:</span><span class="nf">add_anim_action</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">()</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">        </span><span class="nv">actor</span><span class="p">:</span><span class="nf">toggle_counter</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">    </span><span class="kr">end</span><span class="p">)</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="kr">end</span>
</span></code></pre></div>
Note that this example is done specifically in the <code>execute_func</code>, which is the first time the 
user has entered the action animation, but you can still do this elsewhere. Don't forget to 
treat the incoming <code>user</code> for the <code>card_create_action</code> as if it may be different from the <code>actor</code>.
You should be targeting the <code>actor</code>, given in the parameters for the <code>execute_func</code> or returned 
from <code>CardAction.get_actor</code>.</p>
<h3 id="breaking-metal-tiles">Breaking Metal Tiles</h3>
<p>The Metal TileState prevents cracking and breaking a Tile. This means calls like 
<code>tile:set_state(TileState.Cracked)</code> or <code>tile:set_state(TileState.Broken)</code> will do 
nothing if the current state is <code>TileState.Metal</code>. </p>
<p>Some effects intend to <em>overwrite</em> Tiles, which is different flavor from <em>breaking</em> 
them. For example, in BN3, MetalMan, GutsMan, and BassGS don't affect Metal Tiles, 
but Geddon1 and Geddon2 do. Geddon1 cracks all Tiles, including Metal Tiles; Geddon2 
turns all Tiles into holes, but Metal Tiles are instead cracked. If you intend for 
this sort of behavior, you can change the Tile to <code>TileState.Normal</code> and then crack 
and break it, or only crack if it was Metal beforehand. </p>
<h3 id="engine-alert-symbol">Engine Alert Symbol</h3>
<p>v2.1 adds access to <code>Battle.AlertSymbol.new()</code>, which creates an alert symbol, the 
double exclamation point icon that appears when taking weakness damage or performing 
TFC. If your mods have created one for themselves, you may consider using this instead. </p>
<h3 id="turn-counting">Turn Counting</h3>
<p>In v2.0, some mods tried to create attacks or special effects that activated only 
once per turn. This can now be done much more easily and with fewer holes by the 
new <code>Battle.get_turn_count</code>.</p>
<p><code>Battle.get_turn_count</code> returns the current turn of the battle. It will return <code>0.0</code>
before the first turn, then <code>1.0</code> more every time the "Battle Start!" banner appears 
after exiting card select.</p>
<div class="language-lua highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nv">player</span><span class="p">.</span><span class="py">last_known_turn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nv">player</span><span class="p">.</span><span class="py">allow_special_attack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1">-- Set allow_special_component true if it&#39;s a new turn</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="kd">local</span><span class="w"> </span><span class="nv">special_component</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Battle</span><span class="p">.</span><span class="py">Component</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="nv">player</span><span class="p">,</span><span class="w"> </span><span class="nv">Lifetimes</span><span class="p">.</span><span class="py">Scene</span><span class="p">)</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="nv">special_component</span><span class="p">.</span><span class="py">update_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">()</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="kd">local</span><span class="w"> </span><span class="nv">turn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Battle</span><span class="p">.</span><span class="nf">get_turn_count</span><span class="p">()</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">turn</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="nv">player</span><span class="p">.</span><span class="py">last_known_turn</span><span class="w"> </span><span class="kr">then</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">        </span><span class="nv">player</span><span class="p">.</span><span class="py">last_known_turn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">turn</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">        </span><span class="nv">player</span><span class="p">.</span><span class="py">allow_special_attack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">    </span><span class="kr">end</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="kr">end</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="nv">player</span><span class="p">:</span><span class="nf">register_component</span><span class="p">(</span><span class="nv">special_component</span><span class="p">)</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="c1">-- Do nothing if allow_special_attack is false</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="c1">-- Otherwise, return special attack and set </span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="c1">-- allow_special_attack false</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="nv">player</span><span class="p">.</span><span class="py">special_attack_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="nv">self</span><span class="p">)</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">allow_special_attack</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">        </span><span class="kr">return</span><span class="w"> </span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="w">    </span><span class="kr">end</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="w">    </span><span class="kd">local</span><span class="w"> </span><span class="nv">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">Battle</span><span class="p">.</span><span class="py">CardAction</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;PLAYER_IDLE&quot;</span><span class="p">)</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="w">    </span><span class="nv">action</span><span class="p">.</span><span class="py">excute_func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">()</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="w">        </span><span class="nv">self</span><span class="p">.</span><span class="py">allow_special_attack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="w">    </span><span class="kr">end</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">action</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="kr">end</span>
</span></code></pre></div>
<h3 id="new-hitprops-constructor">New HitProps Constructor</h3>
<p>HitProps can now be constructed and modified using a builder pattern.
This is best done using the new constructors, <code>HitProps.new()</code> or 
<code>HitProps.new(context)</code>.</p>
<p>Before:
<div class="language-lua highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">hit_props</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">HitProps</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">    </span><span class="nv">props</span><span class="p">.</span><span class="py">damage</span><span class="p">,</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">    </span><span class="nv">Hit</span><span class="p">.</span><span class="py">Impact</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">Hit</span><span class="p">.</span><span class="py">Flinch</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">Hit</span><span class="p">.</span><span class="py">Stun</span><span class="p">,</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">    </span><span class="nv">props</span><span class="p">.</span><span class="py">element</span><span class="p">,</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="nv">user</span><span class="p">:</span><span class="nf">get_context</span><span class="p">(),</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="nv">Drag</span><span class="p">.</span><span class="py">None</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="p">)</span>
</span></code></pre></div>
Now:
<div class="language-lua highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">hit_props</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">HitProps</span><span class="p">.</span><span class="nf">new</span><span class="p">()</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">    </span><span class="p">:</span><span class="nf">dmg</span><span class="p">(</span><span class="nv">props</span><span class="p">.</span><span class="py">damage</span><span class="p">)</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="p">:</span><span class="nf">impact</span><span class="p">()</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="p">:</span><span class="nf">flinch</span><span class="p">()</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="p">:</span><span class="nf">stun</span><span class="p">()</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">    </span><span class="p">:</span><span class="nf">elem</span><span class="p">(</span><span class="nv">props</span><span class="p">.</span><span class="py">element</span><span class="p">)</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">    </span><span class="p">:</span><span class="nf">from</span><span class="p">(</span><span class="nv">user</span><span class="p">:</span><span class="nf">get_context</span><span class="p">())</span>
</span></code></pre></div>
You no longer need to remember the order of values to give to the constructor, 
and don't have to specify that you will have no Drag. If your attack did have 
Drag, you can decide to do
<div class="language-lua highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nv">hit_props</span><span class="p">:</span><span class="nf">drg</span><span class="p">(</span><span class="nv">Drag</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="nv">user</span><span class="p">:</span><span class="nf">get_facing</span><span class="p">(),</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
</span></code></pre></div></p>
<h3 id="use-element2">Use element2</h3>
<p>With the <a href="#new-hitprops-constructor">new HitProps builder pattern</a>, you can now 
add secondary elements.</p>
<p><div class="language-lua highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">hit_props</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">HitProps</span><span class="p">.</span><span class="nf">new</span><span class="p">()</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span><span class="p">:</span><span class="nf">dmg</span><span class="p">(</span><span class="nv">props</span><span class="p">.</span><span class="py">damage</span><span class="p">)</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span><span class="p">:</span><span class="nf">impact</span><span class="p">()</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="p">:</span><span class="nf">flinch</span><span class="p">()</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span><span class="p">:</span><span class="nf">stun</span><span class="p">()</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">    </span><span class="p">:</span><span class="nf">elem</span><span class="p">(</span><span class="nv">props</span><span class="p">.</span><span class="py">element</span><span class="p">)</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">    </span><span class="p">:</span><span class="nf">elem2</span><span class="p">(</span><span class="nv">Element</span><span class="p">.</span><span class="py">Sword</span><span class="p">)</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">    </span><span class="p">:</span><span class="nf">from</span><span class="p">(</span><span class="nv">user</span><span class="p">:</span><span class="nf">get_context</span><span class="p">())</span>
</span></code></pre></div>
This can be read with <code>hit_props.element2</code>.</p>
<p>Be sure to take <code>element2</code> into account in your DefenseRules, which should react the same 
to primary and secondary element.</p>
<h3 id="use-status-durations">Use Status Durations</h3>
<p>With the <a href="#new-hitprops-constructor">new HitProps builder pattern</a>, you can now 
add durations to certain statuses.</p>
<p><div class="language-lua highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kd">local</span><span class="w"> </span><span class="nv">hit_props</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">HitProps</span><span class="p">.</span><span class="nf">new</span><span class="p">()</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">    </span><span class="p">:</span><span class="nf">dmg</span><span class="p">(</span><span class="nv">props</span><span class="p">.</span><span class="py">damage</span><span class="p">)</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">    </span><span class="p">:</span><span class="nf">impact</span><span class="p">()</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">    </span><span class="p">:</span><span class="nf">flinch</span><span class="p">()</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">    </span><span class="p">:</span><span class="nf">stun</span><span class="p">(</span><span class="nf">frames</span><span class="p">(</span><span class="mi">90</span><span class="p">))</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">    </span><span class="p">:</span><span class="nf">elem</span><span class="p">(</span><span class="nv">props</span><span class="p">.</span><span class="py">element</span><span class="p">)</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">    </span><span class="p">:</span><span class="nf">from</span><span class="p">(</span><span class="nv">user</span><span class="p">:</span><span class="nf">get_context</span><span class="p">())</span>
</span></code></pre></div>
Note that a status generally needs at least two frames of duration to take effect. </p>
<p>The following statuses can be given durations in this way:</p>
<ul>
<li>stun (default 120 frames)</li>
<li>freeze (default 150 frames)</li>
<li>flash (default 120 frames)</li>
<li>root (default 120 frames)</li>
<li>blind (default 300 frames)</li>
<li>confuse (default 110 frames)</li>
<li>bubble (default 150 frames)</li>
</ul>
<h3 id="custgauge-manipulation">CustGauge Manipulation</h3>
<p>It's now possible to read and change the Custom Gauge's duration and speed.</p>
<ul>
<li><code>Battle.get_cust_gauge_value</code>, which returns a double with value <code>0.0</code> at empty gauge and <code>1.0</code> or higher at full, as a percentage completion of the gauge</li>
<li><code>Battle.get_cust_gauge_time</code>, which returns a number in frames for the current gauge time (e.g. 256.0 when gauge is half full with default duration)</li>
<li><code>Battle.get_cust_gauge_max_time</code>, which returns a number in frames for the current max gauge time (e.g. 512.0 for default time)</li>
<li><code>Battle.get_default_cust_gauge_max_time</code>, which returns the default gauge time, 512.0 frames</li>
<li><code>Battle.set_cust_gauge_time</code>, takes in a frametime (like <code>frames(256)</code>) to set current gauge time to</li>
<li><code>Battle.set_cust_gauge_max_time</code>, takes in frametime to set max time to (current time is automatically readjusted to match the percentage of total time it had before, e.g. max time 512 and current time 256 will have current time 100 if you set max time to 200)</li>
<li><code>Battle.reset_cust_gauge_to_default</code>, sets max time to default time</li>
</ul>
<h2 id="behavior-changes-be-aware">Behavior Changes (Be Aware)</h2>
<h3 id="using-hitdrag">Using Hit.Drag</h3>
<p>v2.1 makes Drag interactions much closer to source material. This reveals some 
possible mistakes modders have made with Drag attacks. Below are some nuances that 
may have been unknown before, and that modders should reconsider for attacks that 
inflict Drag:
1. Drag makes the hit Entity totally unable to act for over 20 frames after movement stops
2. Drag and Freeze are fully incompatible. If any attacks have Hit.Freeze and Hit.Drag, they 
   will never cause Freeze. If you have done this, consider removing Hit.Freeze.</p>
<h3 id="drag-endlag">Drag Endlag</h3>
<p>The Drag status now properly keeps Entities from acting for over 20 frames after movement 
stops. This is the Drag endlag, during which <code>Entity.is_moving</code> and <code>Entity.is_sliding</code> 
will return false, which was not the case in v2.0.</p>
<p>See <a href="#safer-card_action_event">safer card_action_event</a>.</p>
<h3 id="movement-endlag">Movement Endlag</h3>
<p>In v2.0, all movement had at least one frame of endlag. Endlag of <code>frames(0)</code> and 
<code>frames(1)</code> were identical. With v2.1, this is no longer the case. </p>
<p>This will affect any MoveEvent that was using <code>frames(0)</code> for its endlag, which 
is most sliding Spells. There is no actual fix necessary, because modders likely 
intended their 0 frame endlag to really be 0 frames, but modders should be aware 
that projectiles may appear to move slightly more quickly. </p>
<p>The actual effect on speed has to do with how long it takes to reach mutiple Tiles 
away. Things that moved two Tiles will reach the second Tile 1 frame faster now that 
the endlag isn't there. Moving three Tiles will reach the third Tile 2 frames faster, 
etc.</p>
<p>If you intended to have an extra frame on each Tile, you can use <code>frames(1)</code> as the 
endlag to replicate how <code>frames(0)</code> looked and moved in v2.0.</p>
<h3 id="spawning-hit-effects">Spawning Hit Effects</h3>
<p>Some Spells will spawn hit effects in their <code>collision_func</code> or <code>attack_func</code>. Some 
mods spawn the effect on the Spell's Tile; others spawn on the hit Entity's Tile. 
Spawning on the Spell's Tile has always been less correct, because the Spell is moving 
and may have already reached the next Tile before the effect was spawned. This could 
mean the effect spawns behind the hit Entity, for example. </p>
<p>Because of the <a href="#movement-endlag">movement endlag change</a>, this may be more noticeable
(but it could have happened in v2.0, too).
If a mod spawned the hit effect on the target's Tile, no change is necessary. If they 
spawned on the Spell's Tile, consider changing this.</p>
<h3 id="deleting-moving-attacks">Deleting Moving Attacks</h3>
<p>Some Spells will delete themselves in their <code>collision_func</code>. If the Spell is moving, 
it may have changed Tiles before the <code>collision_func</code> ran. This means it could have 
been drawn on the next Tile even though it hit on the previous Tile, because Entities 
still draw on the frame <code>Entity:delete()</code> is called.</p>
<p>This draw error could happen in v2.0, but is likely more noticeable now because of the 
<a href="#movement-endlag">movement endlag change</a>.</p>
<p>If you call <code>erase</code> in your <code>delete_func</code>, or if you called <code>erase</code> intead of <code>delete</code>, 
or if you call <code>hide</code> when you called <code>delete</code>, or if you call <code>hide</code> in the <code>delete_func</code>, 
this will never happen to your Spells. If you do not do any of these, consider adding one.
My recommendation is to call <code>Entity.hide</code> in your <code>delete_func</code>.</p>
<h3 id="find_nearest_characters-fix">find_nearest_characters Fix</h3>
<p>In v2.0, <code>Field.find_nearest_characters</code> did not actually return an ordered list, so the 
first item was not necessarily the nearest Character. This is fixed by v2.1. </p>
<p>If you have used <code>find_nearest_characters</code> and intended to target the nearest Character, 
no change is needed; you may notice that you are now actually getting the nearest Character.</p>
<p>If you have avoided <code>find_nearest_characters</code> to use your own solution, or because it did 
not work as expected, consider updating to now use it.</p>
<h3 id="fire-and-grass">Fire and Grass</h3>
<p>Fire element attacks now remove Grass even if they did not hit an Entity. Mods that 
handled this interaction on their own in v2.0 can now remove their implementation, as
the engine will handle it.</p>
<h3 id="grass-lava-effects">Grass, Lava Effects</h3>
<p>Grass now heals Wood Entities. If your Player mods have implemented a sort of grass heal, 
you can now remove this and rely on the engine's. If you do not, your healing effect will
stack with the engine's.</p>
<p>Fire Entities are no longer harmed by Lava Tiles. If you have added FloatShoes to your 
Player mods only to recreate this interaction in v2.0, you can now remove the FloatShoes 
and remain immune to Lava.</p>
<h3 id="new-tilestates">New TileStates</h3>
<p>Because of the new TileStates (Sea, Metal, Sand), mods that attempted to change Tiles 
on the Field to any TileState (e.g. a mod that picks random TileStates each time) 
may want to be updated to support the additions.</p>
<p>Servers that send data for encounters tend to use hardcoded values based on the TileState 
enum (ezencounters does this). Any use of <code>TileState.Hidden</code> on your server encounters 
may now appear as Sea Tiles. See the repo for new values to adjust to.</p>
<h3 id="double-hit-sound">Double Hit Sound</h3>
<p>Because <a href="#let-engine-handle-hit-sounds">the engine now plays default SFX when damage is dealt</a>, 
mods that called <code>Engine.play_audio</code> in their attacks' <code>attack_func</code>s are likely playing 
a second sound on top of the default. </p>
<p>If you have a special sound to play that won't be used by the engine by default, use the 
DefenseFrameStateJudge that's now passed into the <code>attack_func</code> to set the sound with 
<code>DefenseFrameStateJudge.set_hit_sfx</code>, and remove the <code>play_audio</code> call.</p>
<p>Otherwise, if your sound is the sound that the engine will play anyway, remove your 
<code>play_audio</code> call. You can also remove the SFX audio file from the mod if it's not used 
elsewhere.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.expand", "content.code.copy", "content.code.select"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>